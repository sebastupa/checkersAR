<!DOCTYPE html>
<html lang="ro">
<head>
  <meta charset="UTF-8" />
  <title>AR Checkers - HIRO Marker</title>

  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />

  <script src="https://aframe.io/releases/1.4.0/aframe.min.js"></script>
  <script src="https://raw.githack.com/AR-js-org/AR.js/master/aframe/build/aframe-ar.js"></script>
</head>

<body style="margin: 0; overflow: hidden;">
  <a-scene
    embedded
    vr-mode-ui="enabled: false"
    arjs="
      sourceType: webcam;
      sourceWidth: 1280;
      sourceHeight: 960;
      displayWidth: 1280;
      displayHeight: 960;
    "
  >
    <a-marker preset="hiro" scale="0.38 0.38 0.38">

      <!-- MARGINEA TABLEI (mai mare + mai înaltă) -->
      <a-box
        position="0 -0.12 0"
        width="4.3"
        height="0.26"
        depth="4.3"
        color="#b08968"
      ></a-box>

      <!-- PLACA INTERIOARĂ (suprafața de joc) -->
      <!-- top = -0.12 + 0.16/2 = -0.04 -->
      <a-box
        position="0 -0.12 0"
        width="4"
        height="0.16"
        depth="4"
        color="#e6d3a3"
      ></a-box>

      <a-entity id="board-squares"></a-entity>
      <a-entity id="pieces"></a-entity>

    </a-marker>

    <a-entity camera look-controls="enabled: false"></a-entity>
  </a-scene>

  <script>
    const N = 8;
    const BOARD_SIZE = 4;
    const CELL = BOARD_SIZE / N; // 0.5
    const HALF = BOARD_SIZE / 2; // 2

    // placa interioară
    const boardY = -0.12;
    const boardH = 0.16;
    const yTop = boardY + boardH / 2; // -0.04

    // pătrățele (groase + ridicate)
    const squareH = 0.08;
    const gap = 0.03;
    const squareY = yTop + gap + squareH / 2;

    const lightColor = "#fff2cf";
    const darkColor  = "#6b3f1d";

    const boardEl = document.getElementById("board-squares");
    const piecesEl = document.getElementById("pieces");

    function cellToWorld(row, col) {
      const x = -HALF + CELL / 2 + col * CELL;
      const z = -HALF + CELL / 2 + row * CELL;
      return { x, z };
    }

    function addSquare(row, col, color) {
      const { x, z } = cellToWorld(row, col);
      const sq = document.createElement("a-box");
      sq.setAttribute("position", `${x} ${squareY} ${z}`);
      sq.setAttribute("width", CELL);
      sq.setAttribute("height", squareH);
      sq.setAttribute("depth", CELL);
      sq.setAttribute("color", color);
      boardEl.appendChild(sq);
    }

    // generare tablă 8x8
    for (let r = 0; r < N; r++) {
      for (let c = 0; c < N; c++) {
        const isDark = (r + c) % 2 === 1;
        addSquare(r, c, isDark ? darkColor : lightColor);
      }
    }

    // piese
    const pieceH = 0.07;
    const pieceR = 0.14;
    const pieceY = squareY + squareH / 2 + pieceH / 2 + 0.005;

    function addPiece(row, col, color) {
      const { x, z } = cellToWorld(row, col);
      const p = document.createElement("a-cylinder");
      p.setAttribute("position", `${x} ${pieceY} ${z}`);
      p.setAttribute("radius", pieceR);
      p.setAttribute("height", pieceH);
      p.setAttribute("color", color);
      piecesEl.appendChild(p);
    }

    // setup inițial dame
    for (let r = 0; r <= 2; r++) {
      for (let c = 0; c < N; c++) {
        if ((r + c) % 2 === 1) addPiece(r, c, "#f5f5f5");
      }
    }
    for (let r = 5; r <= 7; r++) {
      for (let c = 0; c < N; c++) {
        if ((r + c) % 2 === 1) addPiece(r, c, "#111");
      }
    }
  </script>
</body>
</html>
